<!DOCTYPE html>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<html>

<head>
	<meta name="viewport"
		content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" type="text/css" href="/leaflet/leaflet.css" />
	<link rel="stylesheet" type="text/css" href="/leaflet/leaflet.label.css" />
	<script src="/leaflet/leaflet.js"></script>
	<script src="/js/leaflet.ChineseTmsProviders.js"></script>
	<script src="/js/leaflet.ajax.js"></script>
	<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
	<link href="/css/second.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="/css/sweetalert.css">
	<script type="text/javascript" src="/js/sweetalert-dev.js"></script>
	<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="https://cdn.bootcss.com/echarts/4.4.0-rc.1/echarts-en.common.js"></script>
	<script type="text/javascript" src="/js/sweetalert-dev.js"></script>
	<script type="text/javascript" src="/js/data.js"></script>
	<style>
		html,
		body,
		#map {
			height: 100%;
		}

		body {
			padding: 0;
			margin: 0;
		}

		.label {
			font-weight: 700;
			text-transform: uppercase;
			text-align: center;
			margin-top: -1em;
			visibility: hidden;
			color: black
		}

		#button {
			position: absolute;
			right: 8%;
			top: 1%;
		}

		.sweetAlert {
			width: 80em;
			margin: 0 auto;
			left: 0;
			right: 0;
		}

		.position {
			position: absolute;
			bottom: 1%;
			left: 1%;
			z-index: 1;
			font-size: 15px;
			color: black;
			font-weight: 700;
		}
	</style>
	<title>GIS应用开发方法实验二</title>
</head>

<body>
	<div id="map"></div>
	<div id="button">
		<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
			字段统计<span class="caret"></span>
		</button>
		<ul class="dropdown-menu" role="menu" style="min-width:10%">
			<li><a href="javascript:void(0)" onclick="TJ_type()">基于类型字段</a></li>
			<li class="divider"></li>
			<li><a href="javascript:void(0)" onclick="TJ_peoplelive()">基于居住人数字段</a></li>
		</ul>
	</div>
	<div class="position">
		指针经度：<span id="mouse_lng">119.21256</span>°
		指针纬度：<span id="mouse_lat">26.03750</span>°<br>
		中心经度：<span id="center_lng">119.21256</span>°
		中心纬度：<span id="center_lat">26.03750</span>°
		当前缩放等级：<span id="level">15</span>级
	</div>
	<script type="text/javascript">
		//地图初始化，设置中心位置及显示级别
		function delRepeat(arr) {
			// 定义一个新数组
			var newArr = [];
			// 遍历传进来的数组
			for (var i = 0; i < arr.length; i++) {
				// 如果newArr里没有arr[i]
				if (newArr.indexOf(arr[i]) == -1) {
					// 把arr[i]传进新数组
					newArr.push(arr[i]);
				}
			}
			// 返回新数组
			return newArr;
		}
		function removeEmptyEle(arr) {
			for (var i = 0; i < arr.length; i++) {
				if (arr[i] == null) {
					arr.splice(i, 1);
					i = i - 1; // i - 1 ,因为空元素在数组下标 2 位置，删除空之后，后面的元素要向前补位，
					// 这样才能真正去掉空元素,觉得这句可以删掉的连续为空试试，然后思考其中逻辑
				}
			}
			return arr;
		};


		var data = []
		var t = []
		var s = []
		var p = []
		var type = []
		for (i = 0; i < datas.features.length; i++) {
			/* data[i] = new Array
			data[i].name = datas.features[i].properties.Name
			data[i].type = datas.features[i].properties.Type
			data[i].area = datas.features[i].properties.Shape_Area */
			t[i] = datas.features[i].properties.Type
			s[i] = datas.features[i].properties.Shape_Area
			p[i] = datas.features[i].properties.peoplelive
		}
		type = delRepeat(t)

		var type_count = []
		for (i = 0; i < type.length; i++) {
			type_count[i] = 0
			for (y = 0; y < t.length; y++) {
				if (t[y] == type[i])
					type_count[i]++;
			}
		}

		var type_area = []
		for (i = 0; i < type.length; i++) {
			type_area[i] = 0
			for (y = 0; y < t.length; y++) {
				if (t[y] == type[i])
					type_area[i] += s[y]
			}
		}

		let type_result = [];
		for (let index in type) {
			type_result.push({ value: type_count[index], name: type[index] });
		}

		let type_result2 = [];
		for (let index in type) {
			type_result2.push({ value: type_area[index].toFixed(0), name: type[index] });
		}

		var type_color = ["RGB(255,217,0)", "RGB(76,230,0)", "RGB(255,255,0)", "RGB(255,255,115)", "RGB(197,219,0)", "RGB(255,132,0)", "RGB(115,178,255)", "RGB(146,186,0)", "RGB(115,115,0)", "RGB(255,174,0)", "RGB(97,153,0)"]

		peoplelive = ["0-131人", "131-344人", "344-444人", "444-575人", "575-846人",]
		/* console.log(p) */

		var peoplelive_count = []
		var peoplelive_area = []
		for (i = 0; i < peoplelive.length; i++) {
			peoplelive_count[i] = 0
			peoplelive_area[i] = 0
		}
		for (y = 0; y < p.length; y++) {
			if (0 <= p[y] && p[y] < 131) {
				peoplelive_count[0]++;
				peoplelive_area[0] += s[y];
			}
			if (131 < p[y] && p[y] < 344) {
				peoplelive_count[1]++;
				peoplelive_area[1] += s[y];
			}
			if (344 < p[y] && p[y] < 444) {
				peoplelive_count[2]++;
				peoplelive_area[2] += s[y];
			}
			if (444 < p[y] && p[y] < 575) {
				peoplelive_count[3]++;
				peoplelive_area[3] += s[y];
			}
			if (575 < p[y] && p[y] < 846) {
				peoplelive_count[4]++;
				peoplelive_area[4] += s[y];
			}
		}
		let peoplelive_result = [];
		for (let index in peoplelive) {
			peoplelive_result.push({ value: peoplelive_count[index], name: peoplelive[index] });
		}

		let peoplelive_result2 = [];
		for (let index in peoplelive) {
			peoplelive_result2.push({ value: peoplelive_area[index].toFixed(0), name: peoplelive[index] });
		}

		var peoplelive_color = ["RGB(40,146,199)", "RGB(160,194,155)", "RGB(250,250,100)", "RGB(250,141,52)", "RGB(232,16,20)"]

		var map = L.map('map', {
			center: [26.03276, 119.20553],
			zoom: 15,
			scrollWheelZoom: true
		}
		);

		map.on('mousemove', function (e) {
			document.getElementById("mouse_lng").innerHTML = e.latlng.lng.toFixed(5)
			document.getElementById("mouse_lat").innerHTML = e.latlng.lat.toFixed(5)
		})

		map.on('move', function (e) {
			/* console.log(e.target) */
			document.getElementById("center_lng").innerHTML = map.getCenter().lng.toFixed(5)
			document.getElementById("center_lat").innerHTML = map.getCenter().lat.toFixed(5)
		})

		//设置天地图的电子地图数据的来源。
		var normalm = L.tileLayer.chinaProvider('TianDiTu.Normal.Map', {
			maxZoom: 18,
			minZoom: 5
		});

		var normala = L.tileLayer.chinaProvider('TianDiTu.Normal.Annotion', {
			maxZoom: 18,
			minZoom: 5
		});

		var imgm = L.tileLayer.chinaProvider('TianDiTu.Satellite.Map', {
			maxZoom: 18,
			minZoom: 5
		});

		var imga = L.tileLayer.chinaProvider('TianDiTu.Satellite.Annotion', {
			maxZoom: 18,
			minZoom: 5
		});

		//创建天地图电子地图的图层组，将电子地图与注记图层组合，形成图层组
		var normal = L.layerGroup([normalm, normala]);
		//将天地图电子地图加载到map组件上。
		map.addLayer(normal);


		//创建天地图电子地图的图层组，将电子地图与注记图层组合，形成电子地图图层组
		var normal = L.layerGroup([normalm, normala]);
		//创建天地图影像地图的图层组，将影像地图与注记图层组合，形成影像地图图层组
		var image = L.layerGroup([imgm, imga]);

		var baseLayers = {
			"地图": normal,
			"影像": image
		}
		//定义办公楼标记 
		var sd_type = new L.GeoJSON.AJAX('/data/data2.json', {
			style: styleFunction1,
			//针对每个要素，在加载时绑定一个弹出框
			onEachFeature: function (feature, layer) {
				/* layer.bindPopup('<div>' + feature.properties.name + '<div><br>' + '<img src=' + feature.properties.img + ' style="width: 200px;height: 130px;">' + feature.properties.type + '<div>'); */
				layer.bindPopup('<div style="background-color: aliceblue;margin-top: 10px;border-radius: 10px;">' +
					'<div class="p1" style="padding-top: 5px;"><a>' + feature.properties.Name + '</a></div><div class="p2" style="padding: 5px 10px 5px 10px;width: auto;">' +
					'<span class="p">类型：' + feature.properties.Type + '</span><br>' +
					'<span class="p">周长：' + feature.properties.Shape_Leng.toFixed(2) + '米</span><br>' +
					'<span class="p">面积：' + feature.properties.Shape_Area.toFixed(2) + '平方米</span><br>' +
					'<span class="p">居住人数：' + feature.properties.peoplelive + '</span><br>' +
					'<span class="p">高度：' + feature.properties.Height + '</span></div></div>');

				if (feature.properties.f != "") {
					var label = L.marker(layer.getBounds().getCenter(), {
						icon: L.divIcon({
							className: 'label',
							html: feature.properties.Name,
							iconSize: [5, 5]
						})
					}).addTo(map);
				}
			}

		});
		sd_type.addTo(map);

		var sd_peoplelive = new L.GeoJSON.AJAX('/data/data2.json', {
			style: styleFunction2,
			//针对每个要素，在加载时绑定一个弹出框
			onEachFeature: function (feature, layer) {
				/* layer.bindPopup('<div>' + feature.properties.name + '<div><br>' + '<img src=' + feature.properties.img + ' style="width: 200px;height: 130px;">' + feature.properties.type + '<div>'); */
				layer.bindPopup('<div style="background-color: aliceblue;margin-top: 10px;border-radius: 10px;">' +
					'<div class="p1" style="padding-top: 5px;"><a>' + feature.properties.Name + '</a></div><div class="p2" style="padding: 5px 10px 5px 10px;width: auto;">' +
					'<span class="p">类型：' + feature.properties.Type + '</span><br>' +
					'<span class="p">周长：' + feature.properties.Shape_Leng.toFixed(2) + '米</span><br>' +
					'<span class="p">面积：' + feature.properties.Shape_Area.toFixed(2) + '平方米</span><br>' +
					'<span class="p">居住人数：' + feature.properties.peoplelive + '</span><br>' +
					'<span class="p">高度：' + feature.properties.Height + '</span></div></div>');

				if (feature.properties.f != "") {
					var label = L.marker(layer.getBounds().getCenter(), {
						icon: L.divIcon({
							className: 'label',
							html: feature.properties.Name,
							iconSize: [5, 5]
						})
					}).addTo(map);
				}
			}

		});
		/* sd_peoplelive.addTo(map); */

		//将两个图层组，组成一个对象集合。
		var myLayers = {
			"类型渲染": sd_type,
			"居住人数渲染": sd_peoplelive,
		};

		L.control.layers(baseLayers, myLayers).addTo(map);
		map.on('zoomend', function (e) {
			document.getElementById("level").innerHTML = map.getZoom()
			if (map.getZoom() >= 16) {
				var a = document.getElementsByClassName("leaflet-marker-icon label leaflet-zoom-animated leaflet-clickable")
				for (i = 0; i < a.length; i++) {
					a[i].style.visibility = "visible";
					a[i].style.fontSize = (map.getZoom() - 15) * 5.5 + "px";
				}
			}
			else {
				var a = document.getElementsByClassName("leaflet-marker-icon label leaflet-zoom-animated leaflet-clickable")
				for (i = 0; i < a.length; i++) {
					a[i].style.visibility = "hidden";
				}
			}
		})

		/* 	map.on('click', function (e) {
				L.popup().setLatLng(e.latlng).setContent(e.latlng.toString()).openOn(map)
			}) */
		function styleFunction1(feature) {
			switch (feature.properties.Type) {
				case '主干道':
					return {
						fillColor: "RGB(97,153,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '体育设施':
					return {
						fillColor: "RGB(146,186,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '公共服务设施':
					return {
						fillColor: "RGB(255,255,115)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '公路':
					return {
						fillColor: "RGB(197,219,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '办公楼':
					return {
						fillColor: "RGB(255,217,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '宿舍楼':
					return {
						fillColor: "RGB(255,174,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '教学设施':
					return {
						fillColor: "RGB(255,132,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '未建设用地':
					return {
						fillColor: "RGB(115,115,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '次级道路及广场':
					return {
						fillColor: "RGB(255,255,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '水体':
					return {
						fillColor: "RGB(115,178,255)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
				case '草地':
					return {
						fillColor: "RGB(76,230,0)",
						fillOpacity: 1,
						color: "black",
						weight: 1,
						stroke: true
					};
					break;
			}
		}

		function styleFunction2(feature) {
			if (0 <= feature.properties.peoplelive && feature.properties.peoplelive < 131) {
				return {
					fillColor: "RGB(40,146,199)",
					fillOpacity: 1,
					color: "black",
					weight: 1,
					stroke: true
				};
			}
			if (131 <= feature.properties.peoplelive && feature.properties.peoplelive < 344) {
				return {
					fillColor: "RGB(160,194,155)",
					fillOpacity: 1,
					color: "black",
					weight: 1,
					stroke: true
				};
			}
			if (344 <= feature.properties.peoplelive && feature.properties.peoplelive < 444) {
				return {
					fillColor: "RGB(250,250,100)",
					fillOpacity: 1,
					color: "black",
					weight: 1,
					stroke: true
				};
			}
			if (444 <= feature.properties.peoplelive && feature.properties.peoplelive < 575) {
				return {
					fillColor: "RGB(250,141,52)",
					fillOpacity: 1,
					color: "black",
					weight: 1,
					stroke: true
				};
			}
			if (575 <= feature.properties.peoplelive && feature.properties.peoplelive <= 846) {
				return {
					fillColor: "RGB(232,16,20)",
					fillOpacity: 1,
					color: "black",
					weight: 1,
					stroke: true
				};
			}
		}
		TJ_type = function () {

			swal({
				title: "基于类型字段的信息统计",
				text: `<div class="dropdown"><a type="button" class="btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
                        统计类型<span class="caret"></span></a>
	<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1" >
		<li role="presentation" >
			<a role="menuitem" tabindex="-1" onclick=cd_count()>个数统计</a>
		</li>
        <li role="presentation" class="divider"></li>
		<li role="presentation">
			<a role="menuitem" tabindex="-1" onclick=cd_area()>面积统计</a>
		</li>
        <li role="presentation" class="divider"></li>
	</ul>
</div><div id="count"><div id='count_bar' style='height:20em;width:33em;float:left'></div><div id='count_pie' style='height:20em;width:33em;float:left'></div></div>
      <div id="area" style="display:none;"><div id='area_bar' style='height:20em;width:33em;float:left'></div><div id='area_pie' style='height:20em;width:33em;float:left'></div></div>`,
				html: true,
				customClass: "sweetAlert"
			});

			cd_count = function () {
				document.getElementById("count").style.display = ""
				document.getElementById("area").style.display = "none"
			}
			cd_area = function () {
				document.getElementById("count").style.display = "none"
				document.getElementById("area").style.display = ""
			}


			var count_bar = echarts.init(document.getElementById('count_bar'));
			var option = {
				toolbox: {
					show: true,
					x: '10%',
					feature: {
						dataView: { //数据视图
							show: true
						},
						saveAsImage: {//保存图片
							show: true
						},
					}
				},
				tooltip: {
					show: true,
				},
				xAxis: [
					{
						type: 'category',
						data: type,
						axisLabel: {
							interval: 0,
							formatter: function (value) {
								return value.split("").join("\n");
							}
						}
					}
				],
				grid: {
					top: "20px",
					left: "50px",
					right: "15px",
					bottom: "55px"
				},
				yAxis: [ //纵坐标
					{
						type: 'value',
						axisLabel: {
							show: true,
							formatter: '{value}个',//给Y轴数值添加百分号
						},
						axisLine: {
							lineStyle: {
								color: "black",//纵坐标线条颜色
							}
						}
					}
				],
				series: [
					{
						"name": "个数",
						"type": "bar",
						"data": type_result,
						"itemStyle": {
							normal: {
								label: {
									show: true,
									position: 'top', //柱子上方显示数值
									formatter: '{c}' //数值加上'个'
								},
								color: function (params) {
									// build a color map as your need.
									var colorList = type_color;
									return colorList[params.dataIndex]
								},
							}

						}
					}
				]
			};
			count_bar.setOption(option);

			var count_pie = echarts.init(document.getElementById('count_pie'));
			option = {
				toolbox: {
					show: true,
					x: '10%',
					feature: {
						restore: { //重置
							show: true
						},
						saveAsImage: {//保存图片
							show: true
						},
					}
				},
				tooltip: {
					trigger: 'item',
					formatter: "{a}<br/>{b}: {c}个 ({d}%)",
				},
				legend: {
					type: 'scroll',
					show: true,
					orient: 'vertical',
					x: 'right',
					data: type
				},//图例属性，以饼状图为例，用来说明饼状图每个扇区，data与下边series中data相匹配
				graphic: {
					type: 'text',
					left: 'center',
					top: 'center',
					style: {
						text: '个数统计\n' + type.length + '类\n' + t.length + '单元', //使用“+”可以使每行文字居中
						textAlign: 'center',
						font: 'italic bolder 16px cursive',
						fill: '#000',
						width: 30,
						height: 30
					}
				},//此例饼状图为圆环中心文字显示属性，这是一个原生图形元素组件，功能很多
				series: [
					{
						name: '类别统计',//tooltip提示框中显示内容
						type: 'pie',//图形类型，如饼状图，柱状图等
						radius: ['40%', 95 - 0.8 * type.length + '%'],//饼图的半径，数组的第一项是内半径，第二项是外半径。支持百分比，本例设置成环形图。具体可以看文档或改变其值试一试
						/* roseType:'area',//是否显示成南丁格尔图，默认false */
						itemStyle: {
							normal: {
								label: {
									show: true,
									textStyle: { color: '#3c4858', fontSize: "12" },
									formatter: function (val) {   //让series 中的文字进行换行
										return val.name.split("-").join("\n");
									}
								},//饼图图形上的文本标签，可用于说明图形的一些数据信息，比如值，名称等。可以与itemStyle属性同级，具体看文档
								labelLine: {
									show: true,
									lineStyle: { color: '#3c4858' }
								}//线条颜色
							},//基本样式
							emphasis: {
								shadowBlur: 10,
								shadowOffsetX: 0,
								shadowColor: 'rgba(0, 0, 0, 0.5)',//鼠标放在区域边框颜色
								textColor: '#000'
							}//鼠标放在各个区域的样式
						},
						data: type_result,//数据，数据中其他属性，查阅文档
						color: type_color,//各个区域颜色
					},//数组中一个{}元素，一个图，以此可以做出环形图
				],//系列列表
			};
			count_pie.setOption(option);

			var area_bar = echarts.init(document.getElementById('area_bar'));
			var option = {
				toolbox: {
					show: true,
					x: '18%',
					feature: {
						dataView: { //数据视图
							show: true
						},
						saveAsImage: {//保存图片
							show: true
						},
					}
				},
				tooltip: {
					show: true,
				},
				xAxis: [
					{
						type: 'category',
						data: type,
						axisLabel: {
							interval: 0,
							formatter: function (value) {
								return value.split("").join("\n");
							}
						}
					}
				],
				grid: {
					top: "20px",
					left: "90px",
					right: "15px",
					bottom: "55px"
				},
				yAxis: [ //纵坐标
					{
						type: 'value',
						axisLabel: {
							show: true,
							formatter: '{value}平方米',//给Y轴数值添加百分号
						},
						axisLine: {
							lineStyle: {
								color: "black",//纵坐标线条颜色
							}
						}
					}
				],
				series: [
					{
						"name": "面积",
						"type": "bar",
						"data": type_result2,
						"itemStyle": {
							normal: {
								label: {
									show: true,
									position: 'top', //柱子上方显示数值
									formatter: '{c}' //数值加上'个'
								},
								color: function (params) {
									// build a color map as your need.
									var colorList = type_color;
									return colorList[params.dataIndex]
								},
							}

						}
					}
				]
			};
			area_bar.setOption(option);

			var area_pie = echarts.init(document.getElementById('area_pie'));
			option = {
				toolbox: {
					show: true,
					x: '10%',
					feature: {
						restore: { //重置
							show: true
						},
						saveAsImage: {//保存图片
							show: true
						},
					}
				},
				tooltip: {
					trigger: 'item',
					formatter: "{a}<br/>{b}: {c}个 ({d}%)",
				},
				legend: {
					type: 'scroll',
					show: true,
					orient: 'vertical',
					x: 'right',
					data: type
				},//图例属性，以饼状图为例，用来说明饼状图每个扇区，data与下边series中data相匹配
				graphic: {
					type: 'text',
					left: 'center',
					top: 'center',
					style: {
						text: '面积统计\n' + type.length + '类\n' + t.length + '单元', //使用“+”可以使每行文字居中
						textAlign: 'center',
						font: 'italic bolder 16px cursive',
						fill: '#000',
						width: 30,
						height: 30
					}
				},//此例饼状图为圆环中心文字显示属性，这是一个原生图形元素组件，功能很多
				series: [
					{
						name: '类别统计',//tooltip提示框中显示内容
						type: 'pie',//图形类型，如饼状图，柱状图等
						radius: ['40%', 95 - 0.8 * type.length + '%'],//饼图的半径，数组的第一项是内半径，第二项是外半径。支持百分比，本例设置成环形图。具体可以看文档或改变其值试一试
						/* roseType:'area',//是否显示成南丁格尔图，默认false */
						itemStyle: {
							normal: {
								label: {
									show: true,
									textStyle: { color: '#3c4858', fontSize: "12" },
									formatter: function (val) {   //让series 中的文字进行换行
										return val.name.split("-").join("\n");
									}
								},//饼图图形上的文本标签，可用于说明图形的一些数据信息，比如值，名称等。可以与itemStyle属性同级，具体看文档
								labelLine: {
									show: true,
									lineStyle: { color: '#3c4858' }
								}//线条颜色
							},//基本样式
							emphasis: {
								shadowBlur: 10,
								shadowOffsetX: 0,
								shadowColor: 'rgba(0, 0, 0, 0.5)',//鼠标放在区域边框颜色
								textColor: '#000'
							}//鼠标放在各个区域的样式
						},
						data: type_result2,//数据，数据中其他属性，查阅文档
						color: type_color,//各个区域颜色
					},//数组中一个{}元素，一个图，以此可以做出环形图
				],//系列列表
			};
			area_pie.setOption(option);
		}

		TJ_peoplelive = function () {
			swal({
				title: "基于居住人数字段的信息统计",
				text: `<div class="dropdown"><a type="button" class="btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
			统计类型<span class="caret"></span></a>
<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1" >
<li role="presentation" >
<a role="menuitem" tabindex="-1" onclick=cd_count()>个数统计</a>
</li>
<li role="presentation" class="divider"></li>
<li role="presentation">
<a role="menuitem" tabindex="-1" onclick=cd_area()>面积统计</a>
</li>
<li role="presentation" class="divider"></li>
</ul>
</div><div id="count"><div id='count_bar' style='height:20em;width:33em;float:left'></div><div id='count_pie' style='height:20em;width:33em;float:left'></div></div>
<div id="area" style="display:none;"><div id='area_bar' style='height:20em;width:33em;float:left'></div><div id='area_pie' style='height:20em;width:33em;float:left'></div></div>`,
				html: true,
				customClass: "sweetAlert"
			});

			cd_count = function () {
				document.getElementById("count").style.display = ""
				document.getElementById("area").style.display = "none"
			}
			cd_area = function () {
				document.getElementById("count").style.display = "none"
				document.getElementById("area").style.display = ""
			}

			var count_bar = echarts.init(document.getElementById('count_bar'));
			var option = {
				toolbox: {
					show: true,
					x: '10%',
					feature: {
						dataView: { //数据视图
							show: true
						},
						saveAsImage: {//保存图片
							show: true
						},
					}
				},
				tooltip: {
					show: true,
				},
				xAxis: [
					{
						type: 'category',
						data: peoplelive,
						axisLabel: {
							interval: 0,
							/* formatter: function (value) {
								return value.split("").join("\n");
							} */
						}
					}
				],
				grid: {
					top: "20px",
					left: "50px",
					right: "15px",
					bottom: "55px"
				},
				yAxis: [ //纵坐标
					{
						type: 'value',
						axisLabel: {
							show: true,
							formatter: '{value}个',//给Y轴数值添加百分号
						},
						axisLine: {
							lineStyle: {
								color: "black",//纵坐标线条颜色
							}
						}
					}
				],
				series: [
					{
						"name": "个数",
						"type": "bar",
						"data": peoplelive_result,
						"itemStyle": {
							normal: {
								label: {
									show: true,
									position: 'top', //柱子上方显示数值
									formatter: '{c}' //数值加上'个'
								},
								color: function (params) {
									// build a color map as your need.
									var colorList = peoplelive_color;
									return colorList[params.dataIndex]
								},
							}

						}
					}
				]
			};
			count_bar.setOption(option);

			var count_pie = echarts.init(document.getElementById('count_pie'));
			option = {
				toolbox: {
					show: true,
					x: '10%',
					feature: {
						restore: { //重置
							show: true
						},
						saveAsImage: {//保存图片
							show: true
						},
					}
				},
				tooltip: {
					trigger: 'item',
					formatter: "{a}<br/>{b}: {c}个 ({d}%)",
				},
				legend: {
					type: 'scroll',
					show: true,
					orient: 'vertical',
					x: 'right',
					data: peoplelive
				},//图例属性，以饼状图为例，用来说明饼状图每个扇区，data与下边series中data相匹配
				graphic: {
					type: 'text',
					left: 'center',
					top: 'center',
					style: {
						text: '个数统计\n' + peoplelive.length + '类\n' + p.length + '单元', //使用“+”可以使每行文字居中
						textAlign: 'center',
						font: 'italic bolder 16px cursive',
						fill: '#000',
						width: 30,
						height: 30
					}
				},//此例饼状图为圆环中心文字显示属性，这是一个原生图形元素组件，功能很多
				series: [
					{
						name: '类别统计',//tooltip提示框中显示内容
						type: 'pie',//图形类型，如饼状图，柱状图等
						radius: ['40%', 95 - 0.8 * peoplelive.length + '%'],//饼图的半径，数组的第一项是内半径，第二项是外半径。支持百分比，本例设置成环形图。具体可以看文档或改变其值试一试
						/* roseType:'area',//是否显示成南丁格尔图，默认false */
						itemStyle: {
							normal: {
								label: {
									show: true,
									textStyle: { color: '#3c4858', fontSize: "12" },
									formatter: function (val) {   //让series 中的文字进行换行
										return val.name.split("-").join("\n");
									}
								},//饼图图形上的文本标签，可用于说明图形的一些数据信息，比如值，名称等。可以与itemStyle属性同级，具体看文档
								labelLine: {
									show: true,
									lineStyle: { color: '#3c4858' }
								}//线条颜色
							},//基本样式
							emphasis: {
								shadowBlur: 10,
								shadowOffsetX: 0,
								shadowColor: 'rgba(0, 0, 0, 0.5)',//鼠标放在区域边框颜色
								textColor: '#000'
							}//鼠标放在各个区域的样式
						},
						data: peoplelive_result,//数据，数据中其他属性，查阅文档
						color: peoplelive_color,//各个区域颜色
					},//数组中一个{}元素，一个图，以此可以做出环形图
				],//系列列表
			};
			count_pie.setOption(option);

			var area_bar = echarts.init(document.getElementById('area_bar'));
			var option = {
				toolbox: {
					show: true,
					x: '18%',
					feature: {
						dataView: { //数据视图
							show: true
						},
						saveAsImage: {//保存图片
							show: true
						},
					}
				},
				tooltip: {
					show: true,
				},
				xAxis: [
					{
						type: 'category',
						data: peoplelive,
						axisLabel: {
							interval: 0,
							/* formatter: function (value) {
								return value.split("").join("\n");
							} */
						}
					}
				],
				grid: {
					top: "20px",
					left: "90px",
					right: "15px",
					bottom: "55px"
				},
				yAxis: [ //纵坐标
					{
						type: 'value',
						axisLabel: {
							show: true,
							formatter: '{value}平方米',//给Y轴数值添加百分号
						},
						axisLine: {
							lineStyle: {
								color: "black",//纵坐标线条颜色
							}
						}
					}
				],
				series: [
					{
						"name": "面积",
						"type": "bar",
						"data": peoplelive_result2,
						"itemStyle": {
							normal: {
								label: {
									show: true,
									position: 'top', //柱子上方显示数值
									formatter: '{c}' //数值加上'个'
								},
								color: function (params) {
									// build a color map as your need.
									var colorList = peoplelive_color;
									return colorList[params.dataIndex]
								},
							}

						}
					}
				]
			};
			area_bar.setOption(option);

			var area_pie = echarts.init(document.getElementById('area_pie'));
			option = {
				toolbox: {
					show: true,
					x: '10%',
					feature: {
						restore: { //重置
							show: true
						},
						saveAsImage: {//保存图片
							show: true
						},
					}
				},
				tooltip: {
					trigger: 'item',
					formatter: "{a}<br/>{b}: {c}个 ({d}%)",
				},
				legend: {
					type: 'scroll',
					show: true,
					orient: 'vertical',
					x: 'right',
					data: peoplelive
				},//图例属性，以饼状图为例，用来说明饼状图每个扇区，data与下边series中data相匹配
				graphic: {
					type: 'text',
					left: 'center',
					top: 'center',
					style: {
						text: '面积统计\n' + peoplelive.length + '类\n' + p.length + '单元', //使用“+”可以使每行文字居中
						textAlign: 'center',
						font: 'italic bolder 16px cursive',
						fill: '#000',
						width: 30,
						height: 30
					}
				},//此例饼状图为圆环中心文字显示属性，这是一个原生图形元素组件，功能很多
				series: [
					{
						name: '类别统计',//tooltip提示框中显示内容
						type: 'pie',//图形类型，如饼状图，柱状图等
						radius: ['40%', 95 - 0.8 * peoplelive.length + '%'],//饼图的半径，数组的第一项是内半径，第二项是外半径。支持百分比，本例设置成环形图。具体可以看文档或改变其值试一试
						/* roseType:'area',//是否显示成南丁格尔图，默认false */
						itemStyle: {
							normal: {
								label: {
									show: true,
									textStyle: { color: '#3c4858', fontSize: "12" },
									formatter: function (val) {   //让series 中的文字进行换行
										return val.name.split("-").join("\n");
									}
								},//饼图图形上的文本标签，可用于说明图形的一些数据信息，比如值，名称等。可以与itemStyle属性同级，具体看文档
								labelLine: {
									show: true,
									lineStyle: { color: '#3c4858' }
								}//线条颜色
							},//基本样式
							emphasis: {
								shadowBlur: 10,
								shadowOffsetX: 0,
								shadowColor: 'rgba(0, 0, 0, 0.5)',//鼠标放在区域边框颜色
								textColor: '#000'
							}//鼠标放在各个区域的样式
						},
						data: peoplelive_result2,//数据，数据中其他属性，查阅文档
						color: peoplelive_color,//各个区域颜色
					},//数组中一个{}元素，一个图，以此可以做出环形图
				],//系列列表
			};
			area_pie.setOption(option);
		}
	</script>
</body>

</html>