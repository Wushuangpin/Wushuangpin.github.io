<!DOCTYPE html>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<html>

<head>
	<meta name="viewport"
		content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" type="text/css" href="/leaflet/leaflet.css" />
	<link rel="stylesheet" type="text/css" href="/leaflet/leaflet.label.css" />
	<script src="/leaflet/leaflet.js"></script>
	<script src="/js/leaflet.ChineseTmsProviders.js"></script>
	<script src="/js/leaflet.ajax.js"></script>
	<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
	<link href="/css/second.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="/css/sweetalert.css">
	<script type="text/javascript" src="/js/sweetalert-dev.js"></script>
	<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<style>
		html,
		body,
		#map {
			height: 100%;
		}

		body {
			padding: 0;
			margin: 0;
		}
	</style>
	<title>leaflet加载天地图</title>
</head>

<body>
	<div id="map"></div>
	<script type="text/javascript">
		//地图初始化，设置中心位置及显示级别
		var map = L.map('map', {
			center: [26.1310, 119.3075],
			zoom: 12
		}
		);
		//设置天地图的电子地图数据的来源。
		var normalm = L.tileLayer.chinaProvider('TianDiTu.Normal.Map', {
			maxZoom: 18,
			minZoom: 5
		});

		var normala = L.tileLayer.chinaProvider('TianDiTu.Normal.Annotion', {
			maxZoom: 18,
			minZoom: 5
		});

		var imgm = L.tileLayer.chinaProvider('TianDiTu.Satellite.Map', {
			maxZoom: 18,
			minZoom: 5
		});

		var imga = L.tileLayer.chinaProvider('TianDiTu.Satellite.Annotion', {
			maxZoom: 18,
			minZoom: 5
		});

		//创建天地图电子地图的图层组，将电子地图与注记图层组合，形成图层组
		var normal = L.layerGroup([normalm, normala]);
		//将天地图电子地图加载到map组件上。
		map.addLayer(normal);

		//使用Ajax插件，加载geojson数据。
		var geojsonlayer = new L.GeoJSON.AJAX('/data/data.json', {
			//针对每个要素，在加载时绑定一个弹出框
			onEachFeature: function (feature, layer) {
				console.log(feature)
				console.log(layer)
				/* layer.bindPopup('<div>' + feature.properties.name + '<div><br>' + '<img src=' + feature.properties.img + ' style="width: 200px;height: 130px;">' + feature.properties.type + '<div>'); */
				layer.bindPopup('<div id="' + feature.properties.name + '" class="carousel slide" style="width: 200px;">' +
					'<ol class="carousel-indicators" style="height: 0px">' +
					'<li data-target="#' + feature.properties.name + '" data-slide-to="0" class="active"></li>' +
					'<li data-target="#' + feature.properties.name + '" data-slide-to="1"></li>' +
					'<li data-target="#' + feature.properties.name + '" data-slide-to="2"></li></ol><div class="carousel-inner" id="pic"><div class="item active">' +
					'<img src=' + feature.properties.img1 + ' alt="First slide" style="width: 200px;height: 130px;"><div class="carousel-caption" style="width: 120px;height: 0px;">第一张</div></div><div class="item">' +
					'<img src=' + feature.properties.img2 + ' alt="Second slide" style="width: 200px;height: 130px;"><div class="carousel-caption" style="width: 120px;height: 0px;">第二张</div></div><div class="item">' +
					'<img src=' + feature.properties.img3 + ' alt="Third slide" style="width: 200px;height: 130px;"><div class="carousel-caption" style="width: 120px;height: 0px;">第三张</div></div></div>' +
					'<a class="left carousel-control" style="background:transparent;" href="#' + feature.properties.name + '" role="button" data-slide="prev">' +
					'<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>' +
					'<span class="sr-only">Previous</span></a>' +
					'<a class="right carousel-control" style="background:transparent;" href="#' + feature.properties.name + '" role="button" data-slide="next">' +
					'<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>' +
					'<span class="sr-only">Next</span></a></div>' +
					'<div style="background-color: aliceblue;margin-top: 15px;border-radius: 10px;width: 200px;">' +
					'<div class="p1"><a >' + feature.properties.name + '</a></div><div class="p2">' +
					'<span class="p">地址：' + feature.properties.address + '</span><br>' +
					'<span class="p">类别：' + feature.properties.type + '</span><br>' +
					'<span class="p">保护等级：' + feature.properties.grade + '</span><br>' +
					'<span class="p">所在地：' + feature.properties.located + '</span><br>' +
					'<span class="p">建造年代：' + feature.properties.buildtime + '</span><br>' +
					'<a id="button2" type="button" class="btn btn-default" onclick= swal("' + feature.properties.name + '","' + feature.properties.xiangxi + '")>详情</a></div></div>');
			}
		});
		geojsonlayer.addTo(map);


		//创建天地图电子地图的图层组，将电子地图与注记图层组合，形成电子地图图层组
		var normal = L.layerGroup([normalm, normala]);
		//创建天地图影像地图的图层组，将影像地图与注记图层组合，形成影像地图图层组
		var image = L.layerGroup([imgm, imga]);

		var baseLayers = {
			"地图": normal,
			"影像": image
		}
		//定义办公楼标记 

		var geoMarker = L.marker([26.032901, 119.203695], {}
		).bindPopup('地理科学学院');
		var libraryMarker = L.marker([26.030995, 119.206818], {}
		).bindPopup('图书馆');
		var administrativeMarker = L.marker([26.030999, 119.208585], {}
		).bindPopup('行政楼');
		//将上面三个办公楼标记，组成图层组。
		var officelayerGroup = L.layerGroup([geoMarker, libraryMarker, administrativeMarker]);

		//定义田径场标记，并使用location.png图像作为标记图像
		var sport1Marker = L.marker([26.034301, 119.205964], {
			icon: L.icon({
				iconUrl: '/images/location.png'
			})
		}
		).bindPopup('东区田径场');
		var sport2Marker = L.marker([26.032369, 119.200851], {
			icon: L.icon({
				iconUrl: '/images/location.png'
			})
		}
		).bindPopup('西区田径场');
		var sport3Marker = L.marker([26.025511, 119.211070], {
			icon: L.icon({
				iconUrl: '/images/location.png'
			})
		}
		).bindPopup('南区田径场');
		//将上面三个田径场标记，组成图层组。
		var sportlayerGroup = L.layerGroup([sport1Marker, sport2Marker, sport3Marker]);

		var officelayerGroupq = L.layerGroup([geoMarker, libraryMarker]);
		var sportlayerGroupq = L.layerGroup([sport1Marker, sport2Marker]);
		//将两个图层组，组成一个对象集合。
		var myLayers = {
			"办公楼": officelayerGroup,
			"田径场": sportlayerGroup,
			"办公楼q": officelayerGroupq,
			"田径场q": sportlayerGroupq
		};

		L.control.layers(baseLayers, myLayers).addTo(map);

	</script>
</body>

</html>